@model VeiculoViewModel
@{
    ViewData["Title"] = "Veiculos";
}

<form id="formEditVeiculo" asp-action="editar" asp-controller="veiculos" method="post">

    <input asp-for="ClienteId" type="hidden" />
    <input asp-for="VeiculoId" type="hidden" />

    <div class="form-validacao"></div>

    <div class="row mb-3">
        <div class="col-3">
            <label asp-for="NomeCliente" class="form-label"></label>
            <input asp-for="NomeCliente" type="text" class="form-control form-control-sm" readonly />
            <span asp-validation-for="NomeCliente" class="text-danger"></span>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-2">
            <label asp-for="Placa" class="form-label"></label>
            <input asp-for="Placa" type="text" class="form-control form-control-sm" />
            <span asp-validation-for="Placa" class="text-danger"></span>
        </div>
        <div class="col-3">
            <label asp-for="Marca" class="form-label"></label>
            <input asp-for="Marca" type="text" class="form-control form-control-sm" />
            <span asp-validation-for="Marca" class="text-danger"></span>
        </div>
    </div>

    <div class="row">
        <div class="col-12 text-end">
            <a asp-action="carregareditar" asp-controller="clientes" asp-route-id="@Model.ClienteId" class="btn btn-sm btn-light" id="btnVoltar">Voltar ao cliente</a>
            <button type="submit" class="btn btn-sm btn-primary">Salvar veiculo</button>
        </div>
    </div>
</form>


<script>
    $('#formEditVeiculo').off('submit').on('submit', function (e) {
        e.preventDefault();

        $("#formEditVeiculo").validate();
        if (!$('#formEditVeiculo').valid()) return;

        carregando(true);

        let form = new FormData($(this)[0]);
        $.ajax({
            url: $(this).attr('action'),
            data: form,
            processData: false,
            contentType: false,
            cache: false,
            enctype: 'multipart/form-data',
            type: "PUT",
        }).done(function (dados) {
            window.location.href = '/veiculos';
        }).fail(function (error) {
            processarErros('formEditVeiculo', error.responseJSON.erros);
        }).always(function () {
            carregando(false);
        });
    });
</script>