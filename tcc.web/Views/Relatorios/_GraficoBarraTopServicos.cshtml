@model RelatorioViewModel

<div class="chart-container" style="position: relative; height:100%; width:100%">
    <canvas id="graficoBarraTop"></canvas>
</div>

<script>
    const configurarGraficoBarraTop = (dados) => {
        const servicos = dados.listaServicosExecutadosPeriodo;

        const data = {
            labels: servicos.map((x) => x.descricaoServico),
            datasets: [{
                label: 'Top 3 Serviços executados no período',
                backgroundColor: 'rgba(255, 193, 7, 0.2)',
                borderColor: 'rgba(255, 193, 7, 0.2)',
                borderWidth: 1,
                barPercentage: 0.5,
                data: servicos.map((x) => x.qtdVezes),
            }]
        };

        const config = {
            type: 'bar',
            data: data,
            options: {
                scales:{
                    y:{
                        ticks:{stepSize:1}
                    }
                },
                events: ['mousemove', 'mouseout']
            }
        };

        let canvas = document.getElementById('graficoBarraTop');
        const chart = Chart.getChart(canvas);
        if(chart != undefined) chart.destroy();

        const myChart = new Chart(canvas, config);
    };

    const carregarRelatorioBarraTop = () => {
        carregando(true);

        let form = new FormData($('#formRelatorio')[0]);
        $.ajax({
            url: 'relatorios/periodo/barra/3',
            data: form,
            processData: false,
            contentType: false,
            cache: false,
            enctype: 'multipart/form-data',
            type: "POST",
        }).done(function (retorno) {
            configurarGraficoBarraTop(retorno.dados);
        }).fail(function (error) {
            processarErros('formRelatorio', error.responseJSON.erros);
        }).always(function () {
            carregando(false);
        });
    };
</script>